---
import { EventGallery } from '#/components/event-gallery'
import { getAllGalleryIds, getGallery } from '#/lib/galleries'
import Layout from '#/pages/_Layout.astro'

// Generate static paths for all galleries
export async function getStaticPaths() {
	const galleryIds = getAllGalleryIds()

	return galleryIds.map((id) => {
		const gallery = getGallery(id)
		return {
			params: { slug: gallery?.slug || id },
			props: { gallery },
		}
	})
}

const { gallery } = Astro.props

// Handle case where gallery is not found
if (!gallery) {
	return Astro.redirect('/404')
}
---

<Layout>
	<EventGallery client:load gallery={gallery} />
</Layout>
