{
	"tasks": [
		{
			"id": "1",
			"title": "Knative Infrastructure Setup",
			"description": "Install Knative Serving on AKS with Traefik gateway, configure autoscaling defaults (min-scale: 0, max-scale: 5, target: 50), and set up shared preview secrets per app.",
			"todo": [
				"Add Knative Serving Helm chart/manifests to packages/infra",
				"Configure Knative namespace, autoscaling defaults, and Traefik ingress",
				"Set up Knative domain mapping for ariaamini.com",
				"Create shared preview secrets in preview namespace",
				"Verify wildcard DNS/TLS works with Knative services"
			],
			"dependencies": [],
			"commitSha": null,
			"done": false,
			"notes": ""
		},
		{
			"id": "2",
			"title": "Preview Scripts & Tooling",
			"description": "Build scripts for detecting changed apps, sanitizing branch names (DNS-safe, <=63 chars), and rendering Knative Service manifests with autoscaling annotations.",
			"todo": [
				"Create scripts/preview/changed-apps.ts - detect changed apps in PR",
				"Create scripts/preview/sanitize-branch.ts - DNS-safe slugification",
				"Create scripts/preview/render-manifests.ts - generate Knative YAMLs",
				"Handle priority-demo label (min-scale: 1) in manifest rendering",
				"Output manifests to packages/infra/manifests/previews/pr-<num>/"
			],
			"dependencies": [],
			"commitSha": null,
			"done": false,
			"notes": ""
		},
		{
			"id": "3",
			"title": "CI/CD Workflows & Flux Integration",
			"description": "GitHub Actions workflows for PR preview deployment/cleanup/GC, plus Flux Kustomization and Receiver webhook for GitOps-based reconciliation.",
			"todo": [
				"Create .github/workflows/preview-pr.yml (build, push, render, commit, trigger, poll, post status)",
				"Create .github/workflows/preview-cleanup.yml (remove manifests on PR close/merge)",
				"Create .github/workflows/preview-gc.yml (scheduled 24h TTL cleanup)",
				"Create Flux Kustomization targeting preview-state branch",
				"Create Flux Receiver for webhook-triggered reconciliation",
				"Store webhook URL/secret in GitHub secrets"
			],
			"dependencies": ["1", "2"],
			"commitSha": null,
			"done": false,
			"notes": ""
		},
		{
			"id": "4",
			"title": "Testing & Documentation",
			"description": "Validate all preview scenarios (single/multi-app PRs, long branch names, re-push, cleanup, scale-to-zero) and document usage.",
			"todo": [
				"Test single-app and multi-app PR preview creation",
				"Test branch slugification for edge cases (slashes, long names)",
				"Test re-push updates revision without URL change",
				"Test PR close removes resources",
				"Test TTL GC cleans stale previews",
				"Test scale-to-zero with idle previews and burst scaling",
				"Document preview URL format, priority-demo label, and troubleshooting"
			],
			"dependencies": ["3"],
			"commitSha": null,
			"done": false,
			"notes": ""
		}
	]
}
